extends ./common/layout
block content
  // Breadcrumb Section Begin
  .breacrumb-section
    .container
      .row
        .col-lg-12
          .breadcrumb-text.product-more
            a(href='./home.html')
              i.fa.fa-home
              |  Home
            a(href='./shop.html') Shop
            span Detail
  // Breadcrumb Section Begin
  // Product Shop Section Begin
  section.product-shop.spad.page-details
    .container
      .row
        .col-lg-3
          .filter-widget
            h4.fw-title Categories
            ul.filter-catagories
              li
                a(href='#') Men
              li
                a(href='#') Women
              li
                a(href='#') Kids
          .filter-widget
            h4.fw-title Brand
            .fw-brand-check
              .bc-item
                label(for='bc-calvin')
                  | Calvin Klein
                  input#bc-calvin(type='checkbox')
                  span.checkmark
              .bc-item
                label(for='bc-diesel')
                  | Diesel
                  input#bc-diesel(type='checkbox')
                  span.checkmark
              .bc-item
                label(for='bc-polo')
                  | Polo
                  input#bc-polo(type='checkbox')
                  span.checkmark
              .bc-item
                label(for='bc-tommy')
                  | Tommy Hilfiger
                  input#bc-tommy(type='checkbox')
                  span.checkmark
          .filter-widget
            h4.fw-title Price
            .filter-range-wrap
              .range-slider
                .price-input
                  input#minamount(type='text')
                  input#maxamount(type='text')
              .price-range.ui-slider.ui-corner-all.ui-slider-horizontal.ui-widget.ui-widget-content(data-min='33' data-max='98')
                .ui-slider-range.ui-corner-all.ui-widget-header
                span.ui-slider-handle.ui-corner-all.ui-state-default(tabindex='0')
                span.ui-slider-handle.ui-corner-all.ui-state-default(tabindex='0')
            a.filter-btn(href='#') Filter
          .filter-widget
            h4.fw-title Color
            .fw-color-choose
              .cs-item
                input#cs-black(type='radio')
                label.cs-black(for='cs-black') Black
              .cs-item
                input#cs-violet(type='radio')
                label.cs-violet(for='cs-violet') Violet
              .cs-item
                input#cs-blue(type='radio')
                label.cs-blue(for='cs-blue') Blue
              .cs-item
                input#cs-yellow(type='radio')
                label.cs-yellow(for='cs-yellow') Yellow
              .cs-item
                input#cs-red(type='radio')
                label.cs-red(for='cs-red') Red
              .cs-item
                input#cs-green(type='radio')
                label.cs-green(for='cs-green') Green
          .filter-widget
            h4.fw-title Size
            .fw-size-choose
              .sc-item
                input#s-size(type='radio')
                label(for='s-size') s
              .sc-item
                input#m-size(type='radio')
                label(for='m-size') m
              .sc-item
                input#l-size(type='radio')
                label(for='l-size') l
              .sc-item
                input#xs-size(type='radio')
                label(for='xs-size') xs
          .filter-widget
            h4.fw-title Tags
            .fw-tags
              a(href='#') Towel
              a(href='#') Shoes
              a(href='#') Coat
              a(href='#') Dresses
              a(href='#') Trousers
              a(href='#') Men&apos;s hats
              a(href='#') Backpack
        .col-lg-9
          .row
            .col-lg-6
              .product-pic-zoom
                img.product-big-img(src= product.images[0], alt='')
                .zoom-icon
                  i.fa.fa-search-plus
              .product-thumbs
                .product-thumbs-track.ps-slider.owl-carousel
                  - var i = 0
                  while i < product.images.length
                    if i == 0
                      .pt.active(data-imgbigurl= product.images[i])
                        img(src= product.images[i++] alt='')
                    else
                      .pt.active(data-imgbigurl= product.images[i])
                        img(src= product.images[i++] alt='')
            .col-lg-6
              .product-details
                #error-message.alert.alert-danger
                #added-message.alert.alert-success
                .pd-title
                  span= product.category.name
                  h3= product.name
                  a.heart-icon(href='#')
                    i.icon_heart_alt
                .pd-rating
                  i.fa.fa-star
                  i.fa.fa-star
                  i.fa.fa-star
                  i.fa.fa-star
                  i.fa.fa-star-o
                  span (5)
                .pd-desc
                  p= product.shortDescription
                  if product.salePrice
                    h4= "$" + product.salePrice
                      span= " $" + product.price
                  else 
                    h4= "$" + product.price
                h5.mb-2 Size
                .pd-size-choose
                  each size in product.sizes
                    .sc-item
                      input(type='radio', name='size', value=size, id= size + '-size')
                      label(for= size + '-size')= size
                h5.mb-2 Color
                .pd-color-buton-choose
                  each color in product.colors
                    .sc-item
                      input(type='radio', name='color', value=color, id= color + '-color')
                      label(for= color + '-color')= color
                h5.mb-2 Quantity
                .quantity
                  .pro-qty
                    span(class='dec qtybtn')='-'
                    input#quantity(type='text' value='1', name='quantity')
                    span(class='inc qtybtn')='+'
                  button#add-to-cart.no-border.primary-btn.pd-cart Add To Cart
                ul.pd-tags
                  li
                    span CATEGORIES
                    | : More Accessories, Wallets &amp; Cases
                  li
                    span TAGS : 
                      each tag in product.tags
                        a(href='#')= tag + ", "
                .pd-share
                  .p-code Sku : 00012
                  .pd-social
                    a(href='#')
                      i.ti-facebook
                    a(href='#')
                      i.ti-twitter-alt
                    a(href='#')
                      i.ti-linkedin
          .product-tab
            .tab-item
              ul.nav(role='tablist')
                li
                  a.active(data-toggle='tab' href='#tab-1' role='tab') DESCRIPTION
                li
                  a(data-toggle='tab' href='#tab-2' role='tab') SPECIFICATIONS
                li
                  a(data-toggle='tab' href='#tab-3' role='tab') Customer Reviews (02)
            .tab-item-content
              .tab-content
                #tab-1.tab-pane.fade-in.active(role='tabpanel')
                  .product-content
                    .row
                      .col-lg-7
                        div!= product.detailDescription
                      .col-lg-5
                        img(src= product.images[0] alt='')
                #tab-2.tab-pane.fade(role='tabpanel')
                  .specification-table
                    table
                      tr
                        td.p-catagory Customer Rating
                        td
                          .pd-rating
                            i.fa.fa-star
                            i.fa.fa-star
                            i.fa.fa-star
                            i.fa.fa-star
                            i.fa.fa-star-o
                            span (5)
                      tr
                        td.p-catagory Price
                        td
                          .p-price $495.00
                      tr
                        td.p-catagory Add To Cart
                        td
                          .cart-add + add to cart
                      tr
                        td.p-catagory Availability
                        td
                          .p-stock 22 in stock
                      tr
                        td.p-catagory Weight
                        td
                          .p-weight 1,3kg
                      tr
                        td.p-catagory Size
                        td
                          .p-size Xxl
                      tr
                        td.p-catagory Color
                        td
                          span.cs-color
                      tr
                        td.p-catagory Sku
                        td
                          .p-code 00012
                #tab-3.tab-pane.fade(role='tabpanel')
                  .customer-review-option
                    h4= product.comments.length + " Comments"
                    .comment-option
                      each comment in product.comments
                        .co-item
                          .avatar-pic
                            img(src= comment.user.avatar, alt='')
                          .avatar-text
                            .at-rating
                              -var n = 0
                              while n < 5
                                if n < comment.rate
                                  i.fa.fa-star
                                else 
                                  i.fa.fa-star-o
                                -n++
                            h5= comment.user.fullname
                              span= comment.createdDate
                            .at-reply= comment.content
                    .personal-rating
                      h6 Your Ratind
                      .rating
                        i.fa.fa-star
                        i.fa.fa-star
                        i.fa.fa-star
                        i.fa.fa-star
                        i.fa.fa-star-o
                    .leave-comment
                      h4 Leave A Comment
                      form.comment-form(action='#')
                        .row
                          .col-lg-6
                            input(type='text' placeholder='Name')
                          .col-lg-6
                            input(type='text' placeholder='Email')
                          .col-lg-12
                            textarea(placeholder='Messages')
                            button.site-btn(type='submit') Send message
  // Product Shop Section End
  // Related Products Section End
  .related-products.spad
    .container
      .row
        .col-lg-12
          .section-title
            h2 New Products
      .row
        .col-lg-3.col-sm-6
          .product-item
            .pi-pic
              img(src='img/products/women-1.jpg' alt='')
              .sale Sale
              .icon
                i.icon_heart_alt
              ul
                li.w-icon.active
                  a(href='#')
                    i.icon_bag_alt
                li.quick-view
                  a(href='#') + Quick View
                li.w-icon
                  a(href='#')
                    i.fa.fa-random
            .pi-text
              .catagory-name Coat
              a(href='#')
                h5 Pure Pineapple
              .product-price
                | $14.00
                span $35.00
        .col-lg-3.col-sm-6
          .product-item
            .pi-pic
              img(src='img/products/women-2.jpg' alt='')
              .icon
                i.icon_heart_alt
              ul
                li.w-icon.active
                  a(href='#')
                    i.icon_bag_alt
                li.quick-view
                  a(href='#') + Quick View
                li.w-icon
                  a(href='#')
                    i.fa.fa-random
            .pi-text
              .catagory-name Shoes
              a(href='#')
                h5 Guangzhou sweater
              .product-price
                | $13.00
        .col-lg-3.col-sm-6
          .product-item
            .pi-pic
              img(src='img/products/women-3.jpg' alt='')
              .icon
                i.icon_heart_alt
              ul
                li.w-icon.active
                  a(href='#')
                    i.icon_bag_alt
                li.quick-view
                  a(href='#') + Quick View
                li.w-icon
                  a(href='#')
                    i.fa.fa-random
            .pi-text
              .catagory-name Towel
              a(href='#')
                h5 Pure Pineapple
              .product-price
                | $34.00
        .col-lg-3.col-sm-6
          .product-item
            .pi-pic
              img(src='img/products/women-4.jpg' alt='')
              .icon
                i.icon_heart_alt
              ul
                li.w-icon.active
                  a(href='#')
                    i.icon_bag_alt
                li.quick-view
                  a(href='#') + Quick View
                li.w-icon
                  a(href='#')
                    i.fa.fa-random
            .pi-text
              .catagory-name Towel
              a(href='#')
                h5 Converse Shoes
              .product-price
                | $34.00
  // Related Products Section End
  include ./common/footer
  script.
    $('#error-message').hide();
    $('#added-message').hide();
    $('#add-to-cart').click(function(){
      var data = {};
      var size = $("input[name='size']:checked").val();
      var color = $("input[name='color']:checked").val();
      if(!size){
        $('#error-message').text('Please choose size.');
        $('#error-message').show();
        return;
      }
      if(!color){
        $('#error-message').text('Please choose color.');
        $('#error-message').show();
        return;
      }
      data.size = size;
      data.color = color;
      var quantity = $("#quantity").val();
      quantity = parseInt(quantity);
      if(!quantity || quantity < 1){
        $('#error-message').text('Quantity must be a number and large than 0.');
        $('#error-message').show();
        return;
      }
      data.quantity = quantity;
      $('#error-message').hide();
      var productPath = window.location.pathname;
      $.ajax({
        url: productPath,
        type: "post",
        contentType: "application/json",
        data: JSON.stringify(data),
        dataType: "json",
        success: function(jsonResult) {
          //show frontend cart
          $('#added-message').text('Added this product to cart.');
          $('#added-message').show();
          var cart = jsonResult;
          var totalCart = 0;
          for(let item of cart.items){
            if(item.product.salePrice){
              totalCart += item.product.salePrice*item.quantity;
            } else {
              totalCart += item.product.price*item.quantity;
            }
          }
          $('#cart-total-price').text(totalCart + ' $');
          $('#outside-cart-total-price').text(totalCart + ' $');
          $('#number-of-items').text(cart.items.length);
          $('#cart-table').empty();
          for(let item of cart.items){
            $('#cart-table').append(
              '<tr name="' + item.product._id + '&&' + item.color + '&&' + item.size + '">' + 
                '<td class="si-pic">' + 
                  '<img src="' + item.product.images[0] + '"/>' + 
                '</td>' + 
                '<td class="si-text">' + 
                  '<div class="product-selected">' + 
                    '<p>' + (item.product.salePrice ? item.product.salePrice : item.product.price) + '$ x ' + item.quantity + '</p>' + 
                    '<h6>' + item.product.name + ' - ' + item.color + ' - ' + item.size + '</h6>' +
                  '</div>' + 
                '</td>' + 
                '<td class="si-close">' + 
                  '<i class="ti-close"></i>' + 
                '</td>' +
              '</tr>');
          }
        },
        error: function (jqXhr, textStatus, errorMessage) { // error callback 
          $('#error-message').text('Could not add to cart.');
          $('#error-message').show();
        }
      });
    });
  script.
    
    
    